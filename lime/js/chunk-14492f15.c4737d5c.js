(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-14492f15"],{"129f":function(t,s){t.exports=Object.is||function(t,s){return t===s?0!==t||1/t===1/s:t!=t&&s!=s}},"15b6":function(t,s,e){"use strict";e.r(s);var i=function(){var t=this,s=t.$createElement,i=t._self._c||s;return i("div",{staticClass:"search"},[i("NavBar",{staticClass:"toFixed",attrs:{"text-center":"青柠电影"},on:{"left-click":function(s){return t.$goBack()}}}),i("div",{staticClass:"search-wrap boder toFixed"},[i("div",{staticClass:"input-wrap"},[i("i",{staticClass:"iconfont icon-search"}),i("input",{directives:[{name:"model",rawName:"v-model",value:t.searchValue,expression:"searchValue"}],ref:"search",staticClass:"search-input",attrs:{type:"search",placeholder:"搜电影、搜影院"},domProps:{value:t.searchValue},on:{blur:t.getHistory,input:function(s){s.target.composing||(t.searchValue=s.target.value)}}})]),i("span",{staticClass:"search-btn",on:{click:function(s){return t.$goPage({name:"Home"})}}},[t._v(" 取消 ")])]),i("div",{directives:[{name:"show",rawName:"v-show",value:t.isShowHistory,expression:"isShowHistory"}],staticClass:"search-history"},t._l(t.searchData.movies,(function(s,e){return i("div",{key:e,staticClass:"history-item border"},[i("i",{staticClass:"iconfont icon-time-circle history-icon"}),i("span",{staticClass:"history-word line-ellipsis",on:{click:function(e){t.searchValue=s}}},[t._v(" "+t._s(s)+" ")]),i("i",{staticClass:"iconfont del-word icon-close",on:{click:function(s){return s.stopPropagation(),t.clearHistory(e)}}})])})),0),i("div",{directives:[{name:"show",rawName:"v-show",value:t.movies.list.length>0&&!t.isShowHistory,expression:"movies.list.length > 0 && !isShowHistory"}],staticClass:"block"},[i("div",{staticClass:"tip border"},[t._v("电影/电视剧/综艺")]),i("div",{staticClass:"border"}),t._l(t.movies.list,(function(s,e){return i("Movie",{key:e,class:s.id,attrs:{item:s},on:{movie:t.goMovieDetail}})})),i("div",{staticClass:"tip border result"},[t._v(" 查看全部"+t._s(t.movies.total)+"部影视剧 ")])],2),i("div",{directives:[{name:"show",rawName:"v-show",value:t.cinemas.list.length>0&&!t.isShowHistory,expression:"cinemas.list.length > 0 && !isShowHistory"}],staticClass:"block"},[i("div",{staticClass:"tip border"},[t._v("影院")]),i("CinemaList",{attrs:{cinemas:t.cinemas.list},on:{change:t.selectCinema}}),i("div",{staticClass:"tip border result"},[t._v(" 查看全部"+t._s(t.cinemas.total)+"家电影院 ")])],1),i("div",{directives:[{name:"show",rawName:"v-show",value:0==t.movies.list.length&&0==t.cinemas.list.length&&!t.isShowHistory,expression:"movies.list.length ==0 && cinemas.list.length == 0 && !isShowHistory"}],staticClass:"loading-mask"},[i("img",{attrs:{src:e("4ffd")}}),i("span",[t._v("无相关电影或影院")])])],1)},a=[],o=(e("4de4"),e("a434"),e("ac1f"),e("841c"),e("5530")),r=(e("3246"),e("2f62")),n={name:"Search",data:function(){return{searchValue:"",movies:{list:[],total:0,type:0},cinemas:{list:[],total:0,type:0},isShowHistory:!1,historyData:{movies:[]},searchData:[]}},created:function(){var t=this;this.$nextTick((function(){var s=t.$refs.search;s.focus(),t.isShowHistory=!0,JSON.parse(localStorage.getItem("_sh"))&&(t.searchData=JSON.parse(localStorage.getItem("_sh")))}))},computed:Object(o["a"])(Object(o["a"])({},Object(r["c"])("api",{api:function(t){return t.api}})),Object(r["c"])("homeModule",{location:function(t){return t.location}})),watch:{searchValue:function(t){var s=this;""!==t?(this.$toast("loading",0),this.axios({url:this.api.search,params:{kw:t,cityId:this.location[0].cityId,stype:-1}}).then((function(t){s.$toast.clear(),s.isShowHistory=!1,t.data.movies&&(s.movies={list:[],total:0,type:0},s.movies=Object.assign({},t.data.movies)),t.data.cinemas&&(s.cinemas={list:[],total:0,type:0},s.cinemas=Object.assign({},t.data.cinemas))}))):this.isShowHistory=!0}},methods:{getHistory:function(){var t=this.searchValue;""!=t&&(this.isShowHistory=!1,0==this.historyData.movies.filter((function(s){return s==t})).length&&(this.historyData.movies.unshift(this.searchValue),this.historyData.movies.length>3&&this.historyData.movies.pop(),localStorage.removeItem("_sh"),localStorage.setItem("_sh",JSON.stringify(this.historyData))))},clearHistory:function(t){this.searchData.movies.splice(t,1),0!=this.searchData.movies.length&&(localStorage.removeItem("_sh"),localStorage.setItem("_sh",JSON.stringify(this.searchData)))},goMovieDetail:function(t){this.$goPage({name:"MovieInfo",params:{movieId:t}})},selectCinema:function(t){this.$selectCinema(t)}}},c=n,l=e("2877"),h=Object(l["a"])(c,i,a,!1,null,null,null);s["default"]=h.exports},3246:function(t,s,e){},"4ffd":function(t,s,e){t.exports=e.p+"img/logo.4b1f2144.png"},"841c":function(t,s,e){"use strict";var i=e("d784"),a=e("825a"),o=e("1d80"),r=e("129f"),n=e("14c3");i("search",1,(function(t,s,e){return[function(s){var e=o(this),i=void 0==s?void 0:s[t];return void 0!==i?i.call(s,e):new RegExp(s)[t](String(e))},function(t){var i=e(s,t,this);if(i.done)return i.value;var o=a(t),c=String(this),l=o.lastIndex;r(l,0)||(o.lastIndex=0);var h=n(o,c);return r(o.lastIndex,l)||(o.lastIndex=l),null===h?-1:h.index}]}))},a434:function(t,s,e){"use strict";var i=e("23e7"),a=e("23cb"),o=e("a691"),r=e("50c4"),n=e("7b0b"),c=e("65f0"),l=e("8418"),h=e("1dde"),u=e("ae40"),v=h("splice"),m=u("splice",{ACCESSORS:!0,0:0,1:2}),d=Math.max,f=Math.min,p=9007199254740991,g="Maximum allowed length exceeded";i({target:"Array",proto:!0,forced:!v||!m},{splice:function(t,s){var e,i,h,u,v,m,w=n(this),y=r(w.length),S=a(t,y),b=arguments.length;if(0===b?e=i=0:1===b?(e=0,i=y-S):(e=b-2,i=f(d(o(s),0),y-S)),y+e-i>p)throw TypeError(g);for(h=c(w,i),u=0;u<i;u++)v=S+u,v in w&&l(h,u,w[v]);if(h.length=i,e<i){for(u=S;u<y-i;u++)v=u+i,m=u+e,v in w?w[m]=w[v]:delete w[m];for(u=y;u>y-i+e;u--)delete w[u-1]}else if(e>i)for(u=y-i;u>S;u--)v=u+i-1,m=u+e-1,v in w?w[m]=w[v]:delete w[m];for(u=0;u<e;u++)w[u+S]=arguments[u+2];return w.length=y-i+e,h}})}}]);
//# sourceMappingURL=chunk-14492f15.c4737d5c.js.map