(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-22fbfa51"],{5671:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"M-person"},[a("van-nav-bar",{staticClass:"M-header",attrs:{title:"个人资料","left-text":"返回","left-arrow":"",fixed:""},on:{"click-left":function(t){return e.$goBack()}}}),a("layout-bg",[a("van-cell",{attrs:{title:"头像",center:!0}},[a("div",{staticClass:"M-userImg",style:{backgroundImage:"url("+e.personalInfo.userImg+")"}},[a("van-uploader",{staticClass:"M-upload",attrs:{"after-read":e.uploadUserImg}})],1)]),a("van-cell",{attrs:{title:"用户id",center:!0}},[e._v(e._s(e.personalInfo.userId))]),a("van-cell",{attrs:{title:"手机号",center:!0}},[e._v(e._s(e.personalInfo.phone))]),a("van-cell",{attrs:{title:"昵称","input-align":"right",center:!0}},[a("van-field",{staticClass:"M-field",attrs:{placeholder:"输入昵称","input-align":"right",maxlength:"12"},on:{blur:e.updateNickName,change:e.updateNickName},model:{value:e.personalInfo.nickName,callback:function(t){e.$set(e.personalInfo,"nickName",t)},expression:"personalInfo.nickName"}})],1),a("div",{staticClass:"M-userDesc"},[a("div",{staticClass:"M-desc_content"},[a("van-field",{attrs:{rows:"2",autosize:"",label:"简介",type:"textarea",maxlength:"30",placeholder:"输入简介","show-word-limit":"","input-align":"right"},on:{change:e.updateDesc},model:{value:e.personalInfo.desc,callback:function(t){e.$set(e.personalInfo,"desc",t)},expression:"personalInfo.desc"}})],1)])],1)],1)},o=[],s=(a("c975"),a("a15b"),a("d3b7"),a("ac1f"),a("5319"),a("1276"),a("ade3")),i=(a("5b0a"),{name:"Person",components:{LayoutBg:function(){return a.e("chunk-1ccd0594").then(a.bind(null,"8ce7"))}},data:function(){return{personalInfo:Object(s["a"])({nickName:"",desc:"",phone:"",userId:""},"desc","")}},created:function(){this.getPersonalInfo()},methods:{getPersonalInfo:function(){var e=this,t=localStorage.getItem("__tk");this.$judgeToken(t)||this.axios({method:"GET",url:"/findAccountInfo",params:{appkey:this.appkey,tokenString:t}}).then((function(t){if(e.$toast.clear(),700==t.data.code&&e.$router.push({name:"Login"}),"B001"==t.data.code){var a=t.data.result[0];""==a.desc&&(a.desc="暂无简介"),e.personalInfo=a,e.changeInfo()}}))},uploadUserImg:function(e){var t=this,a=["gif","png","jpg","jpeg"],n=1,o=e.file.type.split("/")[1];if(-1!==a.indexOf(o)){var s=e.file.size/1024/1024;if(s>n)this.$toast("文件允许最大不能超过"+n+"MB");else{var i=e.content.replace(/^data:image\/[A-Za-z]+;base64,/,""),r=localStorage.getItem("__tk");this.$judgeToken(r)||this.axios({method:"POST",url:"/updateAvatar",data:{appkey:this.appkey,tokenString:r,imgType:o,serverBase64Img:i}}).then((function(e){t.$toast.clear(),700==e.data.code&&t.$goPage("Login"),"H001"==e.data.code&&(t.personalInfo.userImg=e.data.userImg,t.changeInfo()),t.$toast(e.data.msg)}))}}else this.$toast("文件类型只支持"+a.join(","))},updateNickName:function(){var e=this;if(""==this.personalInfo.nickName)return this.$toast("昵称不能为空"),void(this.personalInfo.nickName=this.personalInfo.userId);var t=localStorage.getItem("__tk");this.$judgeToken(t)||this.axios({method:"POST",url:"/updateNickName",data:{appkey:this.appkey,tokenString:t,nickName:this.personalInfo.nickName}}).then((function(t){e.$toast.clear(),700==t.data.code?e.$goPage("Login"):(e.$toast(t.data.msg),e.changeInfo())}))},updateDesc:function(){var e=this;if(""==this.personalInfo.desc)return this.$toast("简介不能为空"),void(this.personalInfo.desc="暂无简介");var t=localStorage.getItem("__tk");this.$judgeToken(t)||this.axios({method:"POST",url:"/updateDesc",data:{appkey:this.appkey,tokenString:t,desc:this.personalInfo.desc}}).then((function(t){e.$toast.clear(),700==t.data.code?e.$goPage("Login"):(e.$toast(t.data.msg),e.changeInfo())}))},changeInfo:function(){this.$store.commit("changeInfo",this.personalInfo)}}}),r=i,c=a("2877"),l=Object(c["a"])(r,n,o,!1,null,null,null);t["default"]=l.exports},"5b0a":function(e,t,a){},"7a82":function(e,t,a){var n=a("23e7"),o=a("83ab"),s=a("9bf2");n({target:"Object",stat:!0,forced:!o,sham:!o},{defineProperty:s.f})},ade3:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));a("7a82");function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}},c975:function(e,t,a){"use strict";var n=a("23e7"),o=a("4d64").indexOf,s=a("a640"),i=a("ae40"),r=[].indexOf,c=!!r&&1/[1].indexOf(1,-0)<0,l=s("indexOf"),d=i("indexOf",{ACCESSORS:!0,1:0});n({target:"Array",proto:!0,forced:c||!l||!d},{indexOf:function(e){return c?r.apply(this,arguments)||0:o(this,e,arguments.length>1?arguments[1]:void 0)}})}}]);
//# sourceMappingURL=chunk-22fbfa51.936b20a6.js.map