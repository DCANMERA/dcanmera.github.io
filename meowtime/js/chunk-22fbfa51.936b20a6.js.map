{"version":3,"sources":["webpack:///./src/views/user/Person.vue?c4a0","webpack:///src/views/user/Person.vue","webpack:///./src/views/user/Person.vue?a7d0","webpack:///./src/views/user/Person.vue","webpack:///./node_modules/core-js/modules/es.object.define-property.js","webpack:///./node_modules/@babel/runtime/helpers/esm/defineProperty.js","webpack:///./node_modules/core-js/modules/es.array.index-of.js"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","on","$event","$goBack","style","backgroundImage","personalInfo","userImg","uploadUserImg","_v","_s","userId","phone","updateNickName","model","value","callback","$$v","$set","expression","updateDesc","staticRenderFns","component","$","DESCRIPTORS","objectDefinePropertyModile","target","stat","forced","sham","defineProperty","f","_defineProperty","obj","key","Object","enumerable","configurable","writable","$indexOf","indexOf","arrayMethodIsStrict","arrayMethodUsesToLength","nativeIndexOf","NEGATIVE_ZERO","STRICT_METHOD","USES_TO_LENGTH","ACCESSORS","1","proto","searchElement","apply","arguments","length","undefined"],"mappings":"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","file":"js/chunk-22fbfa51.936b20a6.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"M-person\"},[_c('van-nav-bar',{staticClass:\"M-header\",attrs:{\"title\":\"个人资料\",\"left-text\":\"返回\",\"left-arrow\":\"\",\"fixed\":\"\"},on:{\"click-left\":function($event){return _vm.$goBack()}}}),_c('layout-bg',[_c('van-cell',{attrs:{\"title\":\"头像\",\"center\":true}},[_c('div',{staticClass:\"M-userImg\",style:({backgroundImage: 'url('+_vm.personalInfo.userImg+')'})},[_c('van-uploader',{staticClass:\"M-upload\",attrs:{\"after-read\":_vm.uploadUserImg}})],1)]),_c('van-cell',{attrs:{\"title\":\"用户id\",\"center\":true}},[_vm._v(_vm._s(_vm.personalInfo.userId))]),_c('van-cell',{attrs:{\"title\":\"手机号\",\"center\":true}},[_vm._v(_vm._s(_vm.personalInfo.phone))]),_c('van-cell',{attrs:{\"title\":\"昵称\",\"input-align\":\"right\",\"center\":true}},[_c('van-field',{staticClass:\"M-field\",attrs:{\"placeholder\":\"输入昵称\",\"input-align\":\"right\",\"maxlength\":\"12\"},on:{\"blur\":_vm.updateNickName,\"change\":_vm.updateNickName},model:{value:(_vm.personalInfo.nickName),callback:function ($$v) {_vm.$set(_vm.personalInfo, \"nickName\", $$v)},expression:\"personalInfo.nickName\"}})],1),_c('div',{staticClass:\"M-userDesc\"},[_c('div',{staticClass:\"M-desc_content\"},[_c('van-field',{attrs:{\"rows\":\"2\",\"autosize\":\"\",\"label\":\"简介\",\"type\":\"textarea\",\"maxlength\":\"30\",\"placeholder\":\"输入简介\",\"show-word-limit\":\"\",\"input-align\":\"right\"},on:{\"change\":_vm.updateDesc},model:{value:(_vm.personalInfo.desc),callback:function ($$v) {_vm.$set(_vm.personalInfo, \"desc\", $$v)},expression:\"personalInfo.desc\"}})],1)])],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"M-person\">\r\n    <van-nav-bar class=\"M-header\"\r\n                 title=\"个人资料\"\r\n                 left-text=\"返回\"\r\n                 left-arrow\r\n                 fixed\r\n                 @click-left=\"$goBack()\" />\r\n    <layout-bg>\r\n      <van-cell title=\"头像\"\r\n                :center=\"true\">\r\n        <div class=\"M-userImg\"\r\n             :style=\"{backgroundImage: 'url('+personalInfo.userImg+')'}\">\r\n          <van-uploader class=\"M-upload\"\r\n                        :after-read=\"uploadUserImg\" />\r\n        </div>\r\n      </van-cell>\r\n      <van-cell title=\"用户id\"\r\n                :center=\"true\">{{personalInfo.userId}}</van-cell>\r\n      <van-cell title=\"手机号\"\r\n                :center=\"true\">{{personalInfo.phone}}</van-cell>\r\n      <van-cell title=\"昵称\"\r\n                input-align=\"right\"\r\n                :center=\"true\">\r\n        <van-field v-model=\"personalInfo.nickName\"\r\n                   class=\"M-field\"\r\n                   placeholder=\"输入昵称\"\r\n                   input-align=\"right\"\r\n                   maxlength=\"12\"\r\n                   @blur=\"updateNickName\"\r\n                   @change=\"updateNickName\" />\r\n      </van-cell>\r\n      <div class=\"M-userDesc\">\r\n        <div class=\"M-desc_content\">\r\n          <van-field v-model=\"personalInfo.desc\"\r\n                     rows=\"2\"\r\n                     autosize\r\n                     label=\"简介\"\r\n                     type=\"textarea\"\r\n                     maxlength=\"30\"\r\n                     placeholder=\"输入简介\"\r\n                     show-word-limit\r\n                     input-align=\"right\"\r\n                     @change=\"updateDesc\" />\r\n        </div>\r\n      </div>\r\n    </layout-bg>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n  import \"@/assets/scss/person.scss\";\r\n\r\n  export default {\r\n    name: \"Person\",\r\n\r\n    components: {\r\n      LayoutBg: () => import('@/components/LayoutBg.vue')\r\n    },\r\n\r\n    data() {\r\n      return {\r\n\r\n        personalInfo: {\r\n          nickName: '',\r\n          desc: '',\r\n          phone: '',\r\n          userId: '',\r\n          desc: ''\r\n        },\r\n      };\r\n    },\r\n\r\n    created() {\r\n\r\n      // 获取个人资料\r\n      this.getPersonalInfo();\r\n    },\r\n\r\n    methods: {\r\n\r\n      // 获取个人资料\r\n      getPersonalInfo() {\r\n\r\n        // 获取token\r\n        let tokenString = localStorage.getItem('__tk');\r\n\r\n        // 调用判断用户的token\r\n        if (this.$judgeToken(tokenString)) return;\r\n\r\n        this.axios({\r\n            method: \"GET\",\r\n            url: \"/findAccountInfo\",\r\n            params: {\r\n              appkey: this.appkey,\r\n              tokenString,\r\n            },\r\n          })\r\n          .then(res => {\r\n            this.$toast.clear();\r\n            if (res.data.code == 700) {\r\n\r\n              // token检验无效,则跳到登录页面\r\n              this.$router.push({\r\n                name: \"Login\"\r\n              });\r\n            }\r\n            if (res.data.code == \"B001\") {\r\n              let data = res.data.result[0];\r\n              if (data.desc == '') {\r\n                data.desc = '暂无简介'\r\n              }\r\n              this.personalInfo = data;\r\n              this.changeInfo();\r\n            }\r\n          });\r\n      },\r\n\r\n      // 上传用户头像\r\n      uploadUserImg(file) {\r\n\r\n        //允许文件类型\r\n        let type = ['gif', 'png', 'jpg', 'jpeg'];\r\n\r\n        // 允许最大文件大小 1MB\r\n        let size = 1;\r\n\r\n        // 判断文件类型\r\n        let fileType = file.file.type.split('/')[1];\r\n        if (type.indexOf(fileType) === -1) {\r\n          this.$toast('文件类型只支持' + type.join(','));\r\n          return;\r\n        }\r\n\r\n        // 判断文件大小 B, 1024B = 1KB, 1024KB = 1MB\r\n        let fileSize = file.file.size / 1024 / 1024;\r\n        if (fileSize > size) {\r\n          this.$toast('文件允许最大不能超过' + size + 'MB');\r\n          return;\r\n        }\r\n\r\n        // 处理base64的标记data:image/jpeg;base64,\r\n        let base64 = file.content.replace(/^data:image\\/[A-Za-z]+;base64,/, '');\r\n\r\n        // 获取token\r\n        let tokenString = localStorage.getItem('__tk');\r\n\r\n        // 调用判断用户的token\r\n        if (this.$judgeToken(tokenString)) return;\r\n\r\n        this.axios({\r\n            method: \"POST\",\r\n            url: \"/updateAvatar\",\r\n            data: {\r\n              appkey: this.appkey,\r\n              tokenString,\r\n              imgType: fileType,\r\n              serverBase64Img: base64\r\n            },\r\n          })\r\n          .then(res => {\r\n            this.$toast.clear();\r\n            if (res.data.code == 700) {\r\n              this.$goPage('Login'); // token检验无效,则跳到登录页面\r\n            }\r\n\r\n            if (res.data.code == 'H001') {\r\n              this.personalInfo.userImg = res.data.userImg;\r\n              this.changeInfo();\r\n            }\r\n            this.$toast(res.data.msg);\r\n          });\r\n      },\r\n\r\n      // 修改昵称\r\n      updateNickName() {\r\n        if (this.personalInfo.nickName == '') {\r\n          this.$toast('昵称不能为空');\r\n          this.personalInfo.nickName = this.personalInfo.userId;\r\n          return;\r\n        }\r\n\r\n        // 获取token\r\n        let tokenString = localStorage.getItem('__tk');\r\n\r\n        // 调用判断用户的token\r\n        if (this.$judgeToken(tokenString)) return;\r\n\r\n        this.axios({\r\n            method: \"POST\",\r\n            url: \"/updateNickName\",\r\n            data: {\r\n              appkey: this.appkey,\r\n              tokenString,\r\n              nickName: this.personalInfo.nickName\r\n            },\r\n          })\r\n          .then(res => {\r\n            this.$toast.clear();\r\n            if (res.data.code == 700) {\r\n              this.$goPage('Login'); // token检验无效,则跳到登录页面\r\n            } else {\r\n              this.$toast(res.data.msg);\r\n              this.changeInfo();\r\n            }\r\n          });\r\n      },\r\n\r\n      // 修改简介\r\n      updateDesc() {\r\n        if (this.personalInfo.desc == '') {\r\n          this.$toast('简介不能为空');\r\n          this.personalInfo.desc = '暂无简介';\r\n          return;\r\n        }\r\n\r\n        // 获取token\r\n        let tokenString = localStorage.getItem('__tk');\r\n\r\n        // 调用判断用户的token\r\n        if (this.$judgeToken(tokenString)) return;\r\n\r\n        this.axios({\r\n            method: \"POST\",\r\n            url: \"/updateDesc\",\r\n            data: {\r\n              appkey: this.appkey,\r\n              tokenString,\r\n              desc: this.personalInfo.desc\r\n            },\r\n          })\r\n          .then(res => {\r\n            this.$toast.clear();\r\n            if (res.data.code == 700) {\r\n              this.$goPage('Login'); // token检验无效,则跳到登录页面\r\n            } else {\r\n              this.$toast(res.data.msg);\r\n              this.changeInfo();\r\n            }\r\n          });\r\n      },\r\n\r\n      // 修改store的state中userInfo数据\r\n      changeInfo() {\r\n        this.$store.commit('changeInfo', this.personalInfo)\r\n      }\r\n\r\n    }\r\n\r\n  };\r\n\r\n</script>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Person.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Person.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Person.vue?vue&type=template&id=76e4bd13&\"\nimport script from \"./Person.vue?vue&type=script&lang=js&\"\nexport * from \"./Person.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var $ = require('../internals/export');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar objectDefinePropertyModile = require('../internals/object-define-property');\n\n// `Object.defineProperty` method\n// https://tc39.github.io/ecma262/#sec-object.defineproperty\n$({ target: 'Object', stat: true, forced: !DESCRIPTORS, sham: !DESCRIPTORS }, {\n  defineProperty: objectDefinePropertyModile.f\n});\n","export default function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}","'use strict';\nvar $ = require('../internals/export');\nvar $indexOf = require('../internals/array-includes').indexOf;\nvar arrayMethodIsStrict = require('../internals/array-method-is-strict');\nvar arrayMethodUsesToLength = require('../internals/array-method-uses-to-length');\n\nvar nativeIndexOf = [].indexOf;\n\nvar NEGATIVE_ZERO = !!nativeIndexOf && 1 / [1].indexOf(1, -0) < 0;\nvar STRICT_METHOD = arrayMethodIsStrict('indexOf');\nvar USES_TO_LENGTH = arrayMethodUsesToLength('indexOf', { ACCESSORS: true, 1: 0 });\n\n// `Array.prototype.indexOf` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.indexof\n$({ target: 'Array', proto: true, forced: NEGATIVE_ZERO || !STRICT_METHOD || !USES_TO_LENGTH }, {\n  indexOf: function indexOf(searchElement /* , fromIndex = 0 */) {\n    return NEGATIVE_ZERO\n      // convert -0 to +0\n      ? nativeIndexOf.apply(this, arguments) || 0\n      : $indexOf(this, searchElement, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n"],"sourceRoot":""}